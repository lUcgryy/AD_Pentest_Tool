import jinja2
import os
from datetime import datetime,tzinfo,timedelta

class Zone(tzinfo):
    def __init__(self,offset,isdst,name):
        self.offset = offset
        self.isdst = isdst
        self.name = name
    def utcoffset(self, dt):
        return timedelta(hours=self.offset) + self.dst(dt)
    def dst(self, dt):
            return timedelta(hours=1) if self.isdst else timedelta(0)
    def tzname(self,dt):
         return self.name


def render_template(template_name, data):
    with open(template_name, 'r', encoding='utf-8') as f:
        # file deepcode ignore Jinja2AutoEscapeFalse: <please specify a reason of ignoring this>
        template = jinja2.Template(f.read())
        new_data = template.render(data)
    # save the rendered data to a new file
    os.makedirs('./report', exist_ok=True)
    fixed_time_filename = get_current_time().replace(' ','_').replace(':','-')
    new_file_name = f"./report/_{data['Detail']['Domain']}_{fixed_time_filename}.html"
    with open(new_file_name, 'w', encoding='utf-8') as f:
        f.write(new_data)
        

def get_current_time():
    time = datetime.now(Zone(7,False,'UTC'))
    return time.strftime('%Y-%m-%d %H:%M:%S')