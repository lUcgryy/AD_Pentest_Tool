
from banner import create_advanced_banner
from Enumeration.LDAPSession import *
# from test import *



# Note: The actual import statements might need to be adjusted based on the actual functions and classes defined in these files.
# Tạo mã mới cho file menu với cấu trúc và lựa chọn như yêu cầu

new_menu_code = ""
# Giả định import các module từ các file tương ứng

# from test import *
# from LDAPSession import *
# from test-objectGathering import *
# Lưu ý: Bạn cần thay thế các phần giả định import trên bằng các lệnh import thực tế từ các file của bạn

def gather_information():
    print("\nGather Information:")
    print("1. Get All info")
    print("2. Get Domain Controller")
    print("3. Get Users")
    print("4. Get Computers")
    print("5. Get Groups")
    print("6. Get OUs")
    print("7. Get ACLs")
    print("8. Get All Group Member")
    print("9. Get GPOs")
    print("0. Return to Main Menu")
    choice = input("Enter your choice: ")
    return choice
ldap_session = LDAPSession('192.168.0.104', 'giangtran@capstone.local', 'qwerty123')

def execute_gather_information(choice):
    if choice == '1':
        ldap_session.getAllUsers()
        ldap_session.getAllGroups()
        ldap_session.getAllComputers()
        ldap_session.getAllOUs()
        ldap_session.getAllDCs()
        ldap_session.getGPOs()

        # Call the imported functions for "Get All info"
        print("Getting IP from hostname...")
        ldap_session.get_ip_from_hostname()

        print("Getting naming context...")
        ldap_session.get_naming_context()

        print("Getting all users...")
        ldap_session.get_all_users()

        print("Getting AS REP users...")
        ldap_session.get_as_rep_user()
    # Add additional elif blocks for other choices if necessary
    elif choice == '0':
        return
    else:
        print("Invalid choice. Please select a valid option.")


def scan_vulnerability():
    # Placeholder function for scanning vulnerability
    print("\nScan Vulnerability feature is under development...")

def execute_gather_information(choice, ldap_session):
    if choice == '1':
        ldap_session.get_naming_context()
        ldap_session.getAllUsers()
        ldap_session.getAllGroups()
        ldap_session.getAllComputers()
        ldap_session.getAllOUs()
        ldap_session.getAllDCs()
        ldap_session.getGPOs()

        # Call Get All info function
        print("Getting All Info...")
    elif choice == '2':
        ldap_session.get_naming_context()
        ldap_session.getAllDCs()

        # Call Get Domain Controller function
        print("Getting Domain Controller...")
    elif choice == '3':
        ldap_session.get_naming_context()
        ldap_session.getAllUsers()

        print("Getting users...")
    elif choice == '4':
        ldap_session.get_naming_context()
        ldap_session.getAllComputers()

        print("Getting Computer...")
    elif choice == '5':
        ldap_session.get_naming_context()
        ldap_session.getAllGroups()

        print("Getting Groups...")
    elif choice == '6':
        ldap_session.get_naming_context()
        ldap_session.getAllOUs()

        print("Getting OUs...")
    elif choice == '7':
        ldap_session.get_naming_context()
        ldap_session.getACLs()

        print("Getting ACLs")
    elif choice == '8':
        ldap_session.get_naming_context()
        ldap_session.getAllGroupAndMember()

        print("Getting All Groups Member...")
    elif choice == '9':
        ldap_session.get_naming_context()
        ldap_session.getGPOs()

        print("Getting GPOs...")
    elif choice == '0':
        return
    else:
        print("Invalid choice. Please select a valid option.")

def main_menu():
    print("\\nMain Menu:")
    print("1. Gather Information")
    print("2. Scan Vulnerability")
    print("0. Exit")
    choice = input("Enter your choice: ")
    return choice

def execute_main_choice(choice):
    if choice == '1':
        while True:
            sub_choice = gather_information()
            if sub_choice == '0':
                break
            execute_gather_information(sub_choice, ldap_session)
    elif choice == '2':
        scan_vulnerability()
    elif choice == '0':
        print("Exiting...")
        exit()
    else:
        print("Invalid choice. Please select a valid option.")


if __name__ == "__main__":
    while True:
        user_choice = main_menu()
        execute_main_choice(user_choice)

""

# Ghi mã menu mới vào một file mới để user có thể sử dụng
new_menu_file_path = "/mnt/data/new_menu.py"
with open(new_menu_file_path, "w") as new_menu_file:
    new_menu_file.write(new_menu_code)

new_menu_file_path