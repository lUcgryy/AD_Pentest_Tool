<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Security Vulnerability and Active Directory Report</title>
    <style>
        /* Basic reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        /* Set a background color and a font for the whole page */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f7f7f7;
            line-height: 1.6;
            padding: 20px;
        }
        /* Content styling */
        .report-container {
            max-width: 1000px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        h1, h2, h3 {
            color: #333;
        }
        /* Table styling */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            border: 1px solid #ccc;
            text-align: left;
        }
        th {
            background-color: #007bff;
            color: #ffffff;
        }
        td:hover {
            background-color: #f2f2f2;
        }
        /* Severity color coding */
        .high-severity {
            color: #dc3545;
            font-weight: bold;
        }
        .medium-severity {
            color: #ffc107;
            font-weight: bold;
        }
        .low-severity {
            color: #28a745;
            font-weight: bold;
        }
        .info-severity {
            color: #17a2b8;
            font-weight: bold;
        }
        /* AD Information Styling */
        .ad-info-section {
            background: #e9ecef;
            border-left: 4px solid #007bff;
            padding: 10px;
            margin-top: 20px;
        }
        /* Additional styles for severity and instances */
        .severity-table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }
        
        .severity-table th, 
        .severity-table td {
            text-align: left;
            padding: 8px;
            border: 1px solid #ddd;
        }

        .severity-table th {
            background-color: #080808;
        }

        .severity-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .severity-icon {
            height: 16px;
            width: 16px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 10px;
            vertical-align: middle;
        }

        .critical-icon { background-color: #d9534f; }
        .high-icon { background-color: #f0ad4e; }
        .medium-icon { background-color: #5bc0de; }
        .low-icon { background-color: #5cb85c; }
        .info-icon { background-color: #777; }

        /* Additional styles for visual circles */
        .severity-circles-container {
            text-align: center;
            padding: 20px 0;
        }

        .severity-circle {
            display: inline-block;
            margin: 0 10px;
            text-align: center;
        }

        .severity-number {
            display: block;
            width: 60px;
            height: 60px;
            line-height: 60px;
            border-radius: 50%;
            background-color: #f2f2f2;
            color: #333;
            margin-bottom: 8px;
            font-size: 20px;
            font-weight: bold;
        }

        .critical { background-color: #ebccd1; color: #a94442; }
        .high { background-color: #faebcc; color: #8a6d3b; }
        .medium { background-color: #fcf8e3; color: #8a6d3b; }
        .low { background-color: #dff0d8; color: #3c763d; }
        .informational { background-color: #d9edf7; color: #31708f; }

        .severity-label {
            font-size: 16px;
            color: #333;
        }

/* New styles for the 'Informational' severity section */
.info-severity-chart { border-color: #5bc0de; } /* Color for Informational severity */

/* Additional styles for legend and counts */
.vulnerability-item {
    margin-bottom: 5px;
}

.vulnerability-count {
    float: right;
}

.legend {
    display: inline-block;
    width: 12px;
    height: 12px;
    margin-right: 5px;
}

.legend-csp { background-color: #31708f; }
.legend-email { background-color: #8a6d3b; }
.legend-js { background-color: #d9534f; }
.legend-others { background-color: #777; }

/* ... Add any new styles you need below ... */

/* Additional styles for the Medium severity section */
        .medium-severity-chart { border-color: #f0ad4e; }
        .legend-js-lib { background-color: #f0ad4e; }
/* ... Add any new styles you need below ... */

/* Additional styles for the 'Low Severity' section */
.low-severity-chart { border-color: #f0ad4e; }
.legend-clickjacking { background-color: #f0ad4e; }
.legend-httpOnly { background-color: #f0ad4e; }
.legend-secure { background-color: #f0ad4e; }
/* ... Add any new styles you need below ... */

/*...CSS...*/
.collapsible-content {
    overflow: hidden;
    max-height: 0;
    transition: max-height 0.2s ease-out;
}

.collapsible-title {
    cursor: pointer;
    padding: 10px;
    background-color: #007bff;
    color: white;
    border: none;
    text-align: left;
    outline: none;
    font-size: 15px;
}

.collapsible-title:hover,
.collapsible-title:focus {
    background-color: #0056b3;
}

.collapsible-title:after {
    content: '\002B';
    color: white;
    font-weight: bold;
    float: right;
}

.collapsible-title.active:after {
    content: "\2212";
}

        
    </style>
</head>

<!-- Modal Structure with Table -->
<div id="detailsModal" style="display:none; position:fixed; z-index:1; left:0; top:0; width:100%; height:100%; overflow:auto; background-color:rgba(0,0,0,0.4);">
    <div style="background-color:#fefefe; margin:15% auto; padding:20px; border:1px solid #888; width:60%;">
        <span id="closeModal" style="color:#aaa; float:right; font-size:28px; font-weight:bold; cursor:pointer;">&times;</span>
        <h2>Thông Tin Chi Tiết</h2>
        <!-- Bảng trong Modal để hiển thị thông tin -->
        <table id="modalTable" style="width:100%; border-collapse:collapse;">
            <thead>
                <tr>
                    <th>Thuộc tính</th>
                    <th>Giá trị</th>
                </tr>
            </thead>
            <tbody>
                <!-- Các hàng sẽ được thêm vào đây bằng JavaScript -->
            </tbody>
        </table>
    </div>
</div>


<script>
    document.addEventListener('DOMContentLoaded', () => {
        const tableRows = document.querySelectorAll('table tr');
        tableRows.forEach(row => {
            row.addEventListener('click', () => {
                const modal = document.getElementById('detailsModal');
                const tbody = document.getElementById('modalTable').querySelector('tbody');
    
                // Xóa dữ liệu cũ từ các lần nhấp trước
                tbody.innerHTML = '';
    
                // Lặp qua mỗi ô (cell) trong hàng để thêm vào modal
                Array.from(row.cells).forEach((cell, index) => {
                    const tr = tbody.insertRow();
                    const td1 = tr.insertCell(0);
                    const td2 = tr.insertCell(1);
                    // Giả sử hàng đầu tiên là tiêu đề cột, bạn có thể thay đổi logic này
                    td1.textContent = document.querySelector('table th:nth-child(' + (index + 1) + ')').textContent;
                    td2.textContent = cell.textContent;
                });
    
                // Hiển thị modal
                modal.style.display = 'block';
    
                // Đóng modal khi nhấp vào dấu 'X'
                document.getElementById('closeModal').onclick = function() {
                    modal.style.display = 'none';
                }
    
                // Đóng modal khi nhấp ra ngoài
                window.onclick = function(event) {
                    if (event.target == modal) {
                        modal.style.display = 'none';
                    }
                }
            });
        });
    });
    </script>
    
    

<body>

<div class="report-container">

    <h1>Security Vulnerability Report</h1>

    <!-- Vulnerabilities Section -->
<section>
    <h2>Vulnerabilities</h2>
    <div class="collapsible-section">
        <button class="collapsible-title">Table details</button>
        <div class="collapsible-content">
            <table>
            <tr>
                <th>ID</th>
                <th>Description</th>
                <th>Severity</th>
                <th>Exploit Tool</th>
                <th>Fix Recommendation</th>
            </tr>
            <tr>
                <td>VULN001</td>
                <td>SQL Injection in login form</td>
                <td class="high-severity">High</td>
                <td>SQLMap</td>
                <td>Implement prepared statements and parameterized queries.</td>
            </tr>
            <tr>
                <td>VULN002</td>
                <td>Cross-Site Scripting (XSS) in search field</td>
                <td class="medium-severity">Medium</td>
                <td>BeEF</td>
                <td>Sanitize all user inputs and implement Content Security Policy.</td>
            </tr>
            <tr>
                <td>VULN003</td>
                <td>Insecure Direct Object References (IDOR) in URL parameter</td>
                <td class="low-severity">Low</td>
                <td>N/A</td>
                <td>Implement proper access control checks and session management.</td>
            </tr>
        </table>
    </div>
    </div>
    </section>

    <!-- Severity and Instances Section -->
    <section>
        <h2>Vulnerability Severity and Instances</h2>
        <div class="collapsible-section">
            <button class="collapsible-title">Table details
            </button>
            <div class="collapsible-content">
        <table class="severity-table">
            <thead>
                <tr>
                    <th>Severity</th>
                    <th>Vulnerabilities</th>
                    <th>Instances</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="severity-icon critical-icon"></span> Critical</td>
                    <td>0</td>
                    <td>0</td>
                </tr>
                <tr>
                    <td><span class="severity-icon high-icon"></span> High</td>
                    <td>0</td>
                    <td>0</td>
                </tr>
                <tr>
                    <td><span class="severity-icon medium-icon"></span> Medium</td>
                    <td>1</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td><span class="severity-icon low-icon"></span> Low</td>
                    <td>6</td>
                    <td>7</td>
                </tr>
                <tr>
                    <td><span class="severity-icon info-icon"></span> Informational</td>
                    <td>5</td>
                    <td>11</td>
                </tr>
                <tr>
                    <th>Total</th>
                    <th>12</th>
                    <th>21</th>
                </tr>
            </tbody>
        </table>
        </div>
        </div>
    </section>

    <!-- Scan Details Section -->
    <section>
        <h2>Scan Details</h2>
    <div class="collapsible-section">
        <button class="collapsible-title">Table details</button>
        <div class="collapsible-content">
            <table>
        <tr>
            <th>Target</th>
            <td><a href="https://padtool.com.vn/" target="_blank">https://padtool.com.vn/</a></td>
        </tr>
        <tr>
            <th>Scan Type</th>
            <td>Full Scan</td>
        </tr>
        <tr>
            <th>Start Time</th>
            <td>Apr 1, 2024, 10:00:33 AM GMT+7</td>
        </tr>
        <tr>
            <th>Scan Duration</th>
            <td>2 days</td>
        </tr>
       
    </table>
</div>
</div>
</section>

    <!-- Severity Circles Section -->
    <section class="severity-circles-container">
        <div class="severity-circle">
            <span class="severity-number critical">0</span>
            <span class="severity-label">Critical</span>
        </div>
        <div class="severity-circle">
            <span class="severity-number high">0</span>
            <span class="severity-label">High</span>
        </div>
        <div class="severity-circle">
            <span class="severity-number medium">3</span>
            <span class="severity-label">Medium</span>
        </div>
        <div class="severity-circle">
            <span class="severity-number low">7</span>
            <span class="severity-label">Low</span>
        </div>
        <div class="severity-circle">
            <span class="severity-number informational">11</span>
            <span class="severity-label">Informational</span>
        </div>
    </section>

        <!-- 'Informational' Severity Section -->
<section>
        <h2>Informational</h2>
        <div class="doughnut-chart info-severity-chart"></div>
        <div class="vulnerability-list">
            <div class="vulnerability-item"><span class="legend legend-csp"></span>Content Security Policy (CSP) Not Implemented<span class="vulnerability-count">1</span></div>
            <div class="vulnerability-item"><span class="legend legend-email"></span>Generic Email Address Disclosure<span class="vulnerability-count">1</span></div>
            <div class="vulnerability-item"><span class="legend legend-js"></span>Outdated JavaScript libraries<span class="vulnerability-count">6</span></div>
            <div class="vulnerability-item"><span class="legend legend-others"></span>Others<span class="vulnerability-count">3</span></div>
        </div>
    </section>

    <!-- 'Medium Severity' Section -->
    <section>
        <h2>Medium Severity</h2>
        <div class="doughnut-chart medium-severity-chart"></div>
        <div class="vulnerability-list">
            <div class="vulnerability-item"><span class="legend legend-js-lib"></span>Vulnerable JavaScript libraries<span class="vulnerability-count">3</span></div>
        </div>
    </section>

    <!-- 'Low Severity' Section -->
<section>
    <h2>Low Severity</h2>
    <div class="doughnut-chart low-severity-chart"></div>
    <div class="vulnerability-list">
        <div class="vulnerability-item"><span class="legend legend-clickjacking"></span>Clickjacking: X-Frame-Options header<span class="vulnerability-count">1</span></div>
        <div class="vulnerability-item"><span class="legend legend-httpOnly"></span>Cookies Not Marked as HttpOnly<span class="vulnerability-count">1</span></div>
        <div class="vulnerability-item"><span class="legend legend-secure"></span>Cookies Not Marked as Secure<span class="vulnerability-count">1</span></div>
        <div class="vulnerability-item"><span class="legend legend-others"></span>Others<span class="vulnerability-count">4</span></div>
    </div>
</section>


    <!-- Active Directory Information Section -->
    <section class="ad-info-section">
        <h2>Active Directory Information</h2>
        <div class="collapsible-section">
            <button class="collapsible-title">Users</button>
            <div class="collapsible-content">
        <table>
            <tr>
                <th>Username</th>
                <th>Email</th>
                <th>Groups</th>
            </tr>
            <tr>
                <td>jsmith</td>
                <td>jsmith@example.com</td>
                <td>Administrators, Developers</td>
            </tr>
            <tr>
                <td>mdoe</td>
                <td>mdoe@example.com</td>
                <td>Managers, Reviewers</td>
            </tr>
        </table>
        </div>
        </div>

        <div class="collapsible-section">
            <button class="collapsible-title">Groups</button>
            <div class="collapsible-content">
        <table>
            <tr>
                <th>Group Name</th>
                <th>Members</th>
            </tr>
            <tr>
                <td>Scanlocal</td>
                <td>GiangTran, VuDiep, TuanTran</td>
            </tr>
            <td>AD test</td>
            <td>DungNguyen, Rosinante, Cody</td>
            </div>
            </div>
            </section>
            

            <script>
                document.addEventListener('DOMContentLoaded', (event) => {
                    // Thêm sự kiện rê chuột cho mỗi hàng trong bảng
                    const tableRows = document.querySelectorAll('table tr');
                    tableRows.forEach(row => {
                        row.addEventListener('mouseover', () => {
                            row.style.backgroundColor = '#f0f0f0'; // Thay đổi màu nền khi rê chuột
                        });
                        row.addEventListener('mouseout', () => {
                            row.style.backgroundColor = ''; // Quay lại màu nền mặc định khi rê chuột ra
                        });
                    });
                });
                </script>

                <script>
                    document.addEventListener('DOMContentLoaded', () => {
                        const collapsibles = document.querySelectorAll('.collapsible-title');
                    
                        collapsibles.forEach(collapsible => {
                            collapsible.addEventListener('click', function() {
                                this.classList.toggle('active');
                                var content = this.nextElementSibling;
                                if (content.style.maxHeight){
                                    content.style.maxHeight = null;
                                } else {
                                    content.style.maxHeight = content.scrollHeight + "px";
                                } 
                            });
                        });
                    });
                    </script>
                    
                    
                    
                

        </body>
        </html>
